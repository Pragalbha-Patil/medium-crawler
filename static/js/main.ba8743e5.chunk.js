(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{33:function(e,t,s){},35:function(e,t,s){},47:function(e,t,s){"use strict";s.r(t);var n=s(0),a=s.n(n),r=s(12),c=s.n(r),i=(s(33),s(13)),l=s(14),o=s(16),h=s(15),u=s(5),d=(s(34),s(35),s(1)),j=(n.Component,s(19)),g=s(50),p=s(51),f=(s(37),s(18)),m=s.n(f),b=function(e){Object(o.a)(s,e);var t=Object(h.a)(s);function s(e){var n;return Object(i.a)(this,s),(n=t.call(this,e)).divstatus=function(e){""!==n.state.search?n.setState({show:"show"}):n.setState({show:"hide"})},n.handleEvent=function(e){n.setState({search:e.target.value})},n.hideModal=function(){n.setState({isModalOpen:!1})},n.hideSearchModal=function(){n.setState({isSearchHistoryOpen:!1})},n.state={search_results:["Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending..."],search_history:[],tag:null,search:"",show:"show",timer:null,searchResTimer:null,isModalOpen:!1,currentBlog:null,currentTitle:null,currentAuthor:null,currentRead:null,currentUrl:null,currentTag:null,currentTimeTaken:null,currentComment:null,isSearchHistoryOpen:!1,relatedTags:[]},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){this.divstatus(),this.fetchSearchResults(!1,null)}},{key:"fetchSearchResults",value:function(e,t){var s=this,n=new Headers;n.append("Content-Type","application/json"),n.append("Accept","application/json"),fetch("http://127.0.0.1:5000/get-search-results",{method:"GET",headers:n,redirect:"follow"}).then((function(e){return e.text()})).then((function(n){n=JSON.parse(n);var a=s.state.search_history;a.length?a[0][1]===n.data[0][1]&&(console.log("Match found!"),clearInterval(s.state.searchResTimer)):(n.data.reverse(),n.data.map((function(n,a){0==n[3]&&e&&n[1].toLowerCase()==t.toLowerCase()&&f.notify.show("Result not found for "+n[1]+", showing search for popular tags","error"),s.setState({search_history:[].concat(Object(j.a)(s.state.search_history),[n])})})))})).catch((function(e){return console.log("error",e)}))}},{key:"onlyFetchResults",value:function(){var e=this,t=this.state.timer,s=Object(j.a)(this.state.search_results);if(s.length>=10&&"Pending..."!==s[9])console.log("--- Timer cleared ---"),clearInterval(t),this.setState({timer:null});else{this.divstatus();var n=new Headers;n.append("Content-Type","application/json"),fetch("http://127.0.0.1:5000/get-blogs",{method:"GET",headers:n,redirect:"follow"}).then((function(e){return e.text()})).then((function(t){var s=JSON.parse(t);s.data.map((function(t,s){var n=t[4];e.setState({tag:n}),e.state.search_results[s]=t,s<8&&(e.state.search_results[s+1]="Crawling..."),e.divstatus()})),s.tags.map((function(t,s){e.state.relatedTags[s]=t[1]}));var n=Object(j.a)(new Set(e.state.relatedTags));e.setState({relatedTags:n})})).catch((function(e){return console.log("error",e)}))}}},{key:"getRelatedTags",value:function(){var e=this,t=new Headers;t.append("Content-Type","application/json"),fetch("http://127.0.0.1:5000/get-related-tags",{method:"GET",headers:t,redirect:"follow"}).then((function(e){return e.text()})).then((function(t){var s=JSON.parse(t),n=e.state.relatedTags;e.setState({relatedTags:[]}),s.tags.map((function(t,s){e.setState({relatedTags:[].concat(Object(j.a)(n),[t[1]])})})),console.log(n)})).catch((function(e){return console.log("error",e)}))}},{key:"searchTag",value:function(e){var t=this,s=this.state.search;if(s=e||s.trim().toLowerCase()){console.log("You searched for: "+s),this.setState({search_results:["Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending...","Pending..."],search:s,relatedTags:[]});var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:s})};fetch("http://127.0.0.1:5000/search",n).then((function(e){return e.json()})).then((function(e){return console.log(e)}));var a=setInterval((function(){console.log("Polling server for results"),t.onlyFetchResults()}),2500),r=setInterval((function(){t.fetchSearchResults(!0,s)}),5e3);this.setState({search_history:[]}),this.setState({timer:a,tag:s,searchResTimer:r})}else f.notify.show("Please enter a tag!","error")}},{key:"showDetails",value:function(e){var t=this.state.search_results[e];this.setState({currentTitle:t[1],currentAuthor:t[2],currentRead:t[3],currentTag:t[4],currentBlog:t[5],currentComment:"Not available",currentUrl:t[8],currentTimeTaken:t[9],isModalOpen:!0})}},{key:"showSearchHistory",value:function(){this.setState({isSearchHistoryOpen:!0})}},{key:"handleTagsSearch",value:function(e){console.log("Tag to search: "+e),clearInterval(this.state.timer),this.setState({isModalOpen:!1}),this.searchTag(e),f.notify.show("Fetching results for tag: "+e,"success")}},{key:"render",value:function(){var e=this;return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(m.a,{})," ",Object(d.jsxs)("div",{className:"main",children:[Object(d.jsx)("span",{id:"title",children:"Medium Crawler"})," ",Object(d.jsxs)("form",{className:"main-search",onSubmit:function(t){t.preventDefault(),e.searchTag()},children:[Object(d.jsx)("input",{onChange:this.handleEvent,className:"inp",autoFocus:!0,type:"text",autoComplete:"off",placeholder:"Input a tag to search medium",name:"search",id:"search"}),Object(d.jsx)("button",{type:"submit",className:"btn btn-outline-success",children:Object(d.jsx)("i",{className:"fa fa-search"})})]}),Object(d.jsxs)("h2",{className:"text-center mt-5 search-results",hidden:!this.state.tag,children:["Results for ",Object(d.jsxs)("span",{style:{textDecoration:"underline"},children:['"',this.state.tag,'"']})," will appear below"]})]}),Object(d.jsx)("div",{className:"count",onClick:function(){e.showSearchHistory()},children:Object(d.jsxs)("span",{className:"search-history-count",children:[Object(d.jsx)("i",{className:"fa fa-history",id:"history-icon"}),this.state.search_history.length]})}),Object(d.jsx)("div",{id:this.state.show,className:"content",children:Object(d.jsx)("ol",{className:"blogs",children:this.state.search_results.map((function(t,s){return Object(d.jsx)("li",{className:"blog",onClick:function(){return e.showDetails(s)},children:"e"===t[1]||"r"===t[1]?t:t[1]},s)}))})}),Object(d.jsxs)(g.a,{show:this.state.isModalOpen,onHide:this.hideModal,dialogClassName:"modal-lg",children:[Object(d.jsx)(g.a.Header,{closeButton:!0,children:Object(d.jsx)(g.a.Title,{children:"Blog details"})}),Object(d.jsx)(g.a.Body,{children:Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("span",{children:[Object(d.jsxs)("h5",{className:"current-title",children:["Title: ",this.state.currentTitle]}),Object(d.jsxs)("h6",{className:"current-author",children:["Author: ",this.state.currentAuthor]}),Object(d.jsx)("p",{className:"read-time",children:this.state.currentRead})]}),Object(d.jsx)("p",{className:"current-blog",children:this.state.currentBlog}),Object(d.jsxs)("p",{className:"source-url",children:["Source url: ",Object(d.jsx)("a",{href:this.state.currentUrl,target:"_blank",rel:"noreferrer",children:"Medium"})]}),Object(d.jsxs)("p",{children:["Tags: ",Object(d.jsx)("span",{children:this.state.relatedTags.map((function(t,s){return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("span",{className:"tags",onClick:function(){return e.handleTagsSearch(t)},children:[" ",t," "]},s),Object(d.jsx)("span",{className:"space-between"})]})}))})]}),Object(d.jsxs)("p",{className:"float-left scraping-time",children:["Time taken to scrape: ",this.state.currentTimeTaken," secs"]})]})}),Object(d.jsx)(g.a.Footer,{children:Object(d.jsx)(p.a,{variant:"secondary",onClick:this.hideModal,children:"Close"})})]}),Object(d.jsxs)(g.a,{show:this.state.isSearchHistoryOpen,onHide:this.hideSearchModal,dialogClassName:"modal-dialog",children:[Object(d.jsx)(g.a.Header,{closeButton:!0,children:Object(d.jsx)(g.a.Title,{children:"Search history"})}),Object(d.jsx)(g.a.Body,{children:this.state.search_history.map((function(e,t){return Object(d.jsx)("ul",{children:Object(d.jsxs)("li",{children:[Object(d.jsx)("span",{className:"search-history",children:e[1].toUpperCase()})," searched at ",e[2]]})},e[0])}))}),Object(d.jsx)(g.a.Footer,{children:Object(d.jsx)(p.a,{variant:"secondary",onClick:this.hideSearchModal,children:"Close"})})]})]})}}]),s}(n.Component),O=function(e){Object(o.a)(s,e);var t=Object(h.a)(s);function s(){return Object(i.a)(this,s),t.apply(this,arguments)}return Object(l.a)(s,[{key:"render",value:function(){return Object(d.jsx)(a.a.Fragment,{children:Object(d.jsx)(u.c,{children:Object(d.jsx)(u.a,{path:"/",component:b})})})}}]),s}(n.Component),x=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,52)).then((function(t){var s=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;s(e),n(e),a(e),r(e),c(e)}))},v=s(23);c.a.render(Object(d.jsx)(v.a,{children:Object(d.jsx)(O,{})}),document.getElementById("root")),x()}},[[47,1,2]]]);
//# sourceMappingURL=main.ba8743e5.chunk.js.map